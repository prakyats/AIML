import pandas as pd
from sklearn.model_selection import train_test_split as tts
from sklearn.preprocessing import StandardScaler as ss
from sklearn.cluster import KMeans
from sklearn.datasets import make_blobs
import matplotlib.pyplot as plt

X , y = make_blobs(n_samples= 1000, centers=3,n_features=2 )
X,y

plt.scatter(X[:,0],X[:,1],c=y)

X_train, X_test, y_train , y_test = tts( X , y , random_state =42 , test_size=0.33 )

scaler=ss()
X_train_s=scaler.fit_transform(X_train)
X_test_s=scaler.fit_transform(X_test)

wcss=[]
for k in range(1,11):
    kmeans=KMeans(n_clusters=k, init="k-means++")
    kmeans.fit(X_train_s)
    wcss.append(kmeans.inertia_)

wcss

plt.plot(range(1,11),wcss)
plt.xticks(range(1,11))
plt.xlabel("Number of Clusters")
plt.ylabel("WCSS")
plt.show()

kmeans=KMeans(n_clusters=3, init="k-means++")
kmeans.fit_predict(X_train_s)

y_pred=kmeans.predict(X_test_s)
y_pred

plt.scatter(X_test[:,0],X_test[:,1],c=y_pred)
plt.show()
